# Aunsorm Microservices Environment Configuration

# Network Configuration
COMPOSE_PROJECT_NAME=aunsorm
NETWORK_NAME=aunsorm-network

# Service Ports
ID_SERVICE_PORT=50001
CLI_GATEWAY_PORT=50002
ACME_SERVICE_PORT=50003
X509_SERVICE_PORT=50004
AUTH_SERVICE_PORT=50005
E2EE_SERVICE_PORT=50006
MDM_SERVICE_PORT=50007
KMS_SERVICE_PORT=50008
CRYPTO_SERVICE_PORT=50009
AUNSORM_SERVICE_PORT=50010
BLOCKCHAIN_SERVICE_PORT=50011
RNG_SERVICE_PORT=50012
METRICS_SERVICE_PORT=50013
PQC_SERVICE_PORT=50014
GATEWAY_PORT=50015

# Security Configuration
JWT_SECRET_KEY=your-secret-key-here
JWT_EXPIRES_IN=3600

# Host Configuration (Production override)
# Set ZASIAN_HOST and HOST for production deployment
# ZASIAN_HOST=zasian.production.domain  # Override localhost for Zasian services
# HOST=aunsorm.production.domain       # Override 127.0.0.1 for Aunsorm services

# OAuth Configuration
# OAUTH_PRODUCTION_CALLBACK=https://prod.example.com/oauth/callback  # Production OAuth callback

# CLI Configuration
# AUNSORM_SERVER_URL=http://prod.aunsorm.domain:8080  # Override CLI default server URL
# HOSTNAME=prod.aunsorm.domain  # Override CLI default hostname

# Service Configuration (Internal Docker)
# These are typically set by compose.yaml but can be overridden
# AUNSORM_LISTEN=0.0.0.0:50010  # Service bind address (internal)
# SERVICE_MODE=gateway  # Service operation mode
# CLI_MAX_FILE_SIZE=100MB  # CLI Gateway max file upload size
# CLI_TIMEOUT=300s  # CLI Gateway operation timeout
# AUTH_SERVICE_URL=http://auth-service:50011  # Internal auth service URL

# SFU Bridge Configuration (Zasian Media Platform v0.6.0)
# Updated ports: gateway(50030), sfu-router-ws(50031), signaling(50036)
BRIDGE_URL=ws://localhost:50031/ws
# ZASIAN_WEBSOCKET_URL=wss://localhost:50036/zasian  # Override for production

# Zasian Integration (JWT and WebRTC)
# JWT_AUDIENCE=zasian-media  # JWT audience for Zasian tokens (see port-map.yaml)
# TLS_TERMINATION=gateway    # TLS termination strategy

# Database Configuration (if needed)
DATABASE_URL=sqlite://aunsorm.db

# Logging
RUST_LOG=info
RUST_BACKTRACE=1

# Development Mode
DEV_MODE=false  # Set to false for production
DEBUG_ENDPOINTS=false

# Clock Attestation Max Age (seconds)
# ‚ö†Ô∏è  PRODUCTION: Use 30 seconds with NTP refresh service
# üìã STAGING: Can use 300 seconds (5 min) with manual updates
# üîÑ Recommendation: Deploy NTP attestation server for auto-refresh
AUNSORM_CLOCK_MAX_AGE_SECS=300  # Change to 30 for production!

# Calibration & Clock Attestation (Required for all services)
# UYARI: Bu development mock deƒüerleridir! Production'da ger√ßek kalibrasyon kullanƒ±n!
# 
# SecureClockSnapshot format (crates/core/src/clock.rs):
# - authority_id: NTP authority identifier (e.g., "ntp.dev.aunsorm")
# - authority_fingerprint_hex: 64-char hex certificate fingerprint
# - unix_time_ms: Current UNIX timestamp in milliseconds (must be recent!)
# - stratum: NTP stratum level (typically 2 for dev)
# - round_trip_ms: Network round-trip delay estimate
# - dispersion_ms: Clock uncertainty window
# - estimated_offset_ms: Offset between local and authority clock
# - signature_b64: Base64url signature (mock for dev)
#
# √ñrnek i√ßin bakƒ±nƒ±z: crates/server/src/tests.rs setup_state() fonksiyonu
AUNSORM_CALIBRATION_FINGERPRINT=0000000000000000000000000000000000000000000000000000000000000000
AUNSORM_CLOCK_ATTESTATION={"authority_id":"ntp.dev.aunsorm","authority_fingerprint_hex":"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa","unix_time_ms":1761781627788,"stratum":2,"round_trip_ms":8,"dispersion_ms":12,"estimated_offset_ms":4,"signature_b64":"ZGV2X21vY2tfc2lnbmF0dXJl"}