# Aunsorm Microservices Environment Configuration

# Network Configuration
COMPOSE_PROJECT_NAME=aunsorm
NETWORK_NAME=aunsorm-network

# Service Ports (Matching compose.yaml actual mappings)
GATEWAY_PORT=50010                # Main API Gateway
AUTH_SERVICE_PORT=50011          # JWT/OAuth Authentication  
CRYPTO_SERVICE_PORT=50012        # Core Cryptography
X509_SERVICE_PORT=50013          # Certificate Management
KMS_SERVICE_PORT=50014           # Key Management System
MDM_SERVICE_PORT=50015           # Mobile Device Management
ID_SERVICE_PORT=50016            # Identity Management
ACME_SERVICE_PORT=50017          # ACME/Let's Encrypt
PQC_SERVICE_PORT=50018           # Post-Quantum Cryptography
RNG_SERVICE_PORT=50019           # Random Number Generator
BLOCKCHAIN_SERVICE_PORT=50020     # Blockchain Operations
E2EE_SERVICE_PORT=50021          # End-to-End Encryption
METRICS_SERVICE_PORT=50022       # Monitoring/Metrics
CLI_GATEWAY_PORT=50023           # CLI Gateway Interface

# Legacy aliases (deprecated - use specific service ports above)
AUNSORM_SERVICE_PORT=50010       # ‚Üí Use GATEWAY_PORT instead

# Security Configuration
JWT_SECRET_KEY=your-secret-key-here
JWT_EXPIRES_IN=3600

# Host Configuration (Production override)
# Set ZASIAN_HOST and HOST for production deployment
# ZASIAN_HOST=zasian.production.domain  # Override localhost for Zasian services
# HOST=aunsorm.production.domain       # Override 127.0.0.1 for Aunsorm services

# OAuth Configuration
# OAUTH_PRODUCTION_CALLBACK=https://prod.example.com/oauth/callback  # Production OAuth callback

# CLI Configuration
# AUNSORM_SERVER_URL=http://prod.aunsorm.domain:8080  # Override CLI default server URL
# HOSTNAME=prod.aunsorm.domain  # Override CLI default hostname

# Service Configuration (Internal Docker)
# These are typically set by compose.yaml but can be overridden
# AUNSORM_LISTEN=0.0.0.0:50010  # Service bind address (internal)
# SERVICE_MODE=gateway  # Service operation mode
# CLI_MAX_FILE_SIZE=100MB  # CLI Gateway max file upload size
# CLI_TIMEOUT=300s  # CLI Gateway operation timeout
# AUTH_SERVICE_URL=http://auth-service:50011  # Internal auth service URL

# SFU Bridge Configuration (Zasian Media Platform v0.6.0)
# Updated ports: gateway(50030), sfu-router-ws(50031), signaling(50036)
BRIDGE_URL=ws://localhost:50031/ws
# ZASIAN_WEBSOCKET_URL=wss://localhost:50036/zasian  # Override for production

# Zasian Integration (JWT and WebRTC)
# JWT_AUDIENCE=zasian-media  # JWT audience for Zasian tokens (see port-map.yaml)
# TLS_TERMINATION=gateway    # TLS termination strategy

# Database Configuration (if needed)
DATABASE_URL=sqlite://aunsorm.db

# Logging
RUST_LOG=info
RUST_BACKTRACE=1

# Development Mode
DEV_MODE=false  # Set to false for production
DEBUG_ENDPOINTS=false

# Clock Attestation Max Age (seconds)
# ‚ö†Ô∏è  PRODUCTION: Use 30 seconds with NTP refresh service
# üìã STAGING: Can use 300 seconds (5 min) with manual updates
# üîÑ Recommendation: Deploy NTP attestation server for auto-refresh
AUNSORM_CLOCK_MAX_AGE_SECS=300  # Change to 30 for production!

# Calibration & Clock Attestation (Required for all services)
# UYARI: Bu development mock deƒüerleridir! Production'da ger√ßek kalibrasyon kullanƒ±n!
# 
# ‚è∞ TIMESTAMP AUTO-UPDATE: Server otomatik olarak unix_time_ms'i current time'a g√ºnceller
# üìÖ .env dosyasƒ±ndaki eski timestamp deƒüerleri normal - server runtime'da override edilir
# 
# SecureClockSnapshot format (crates/core/src/clock.rs):
# - authority_id: NTP authority identifier (e.g., "ntp.dev.aunsorm")
# - authority_fingerprint_hex: 64-char hex certificate fingerprint
# - unix_time_ms: UNIX timestamp in milliseconds (AUTO-UPDATED by server at startup!)
# - stratum: NTP stratum level (typically 2 for dev)
# - round_trip_ms: Network round-trip delay estimate
# - dispersion_ms: Clock uncertainty window
# - estimated_offset_ms: Offset between local and authority clock
# - signature_b64: Base64url signature (mock for dev)
#
# üîÑ NOTE: unix_time_ms is automatically updated to current time by server
# üìù You don't need to keep this timestamp current in .env file
# üè≠ Production: Use real NTP server with live attestation updates
#
# √ñrnek i√ßin bakƒ±nƒ±z: crates/server/src/tests.rs setup_state() fonksiyonu
AUNSORM_CALIBRATION_FINGERPRINT=f4c9b1a27e38d34d9c0f4f8a96b3e2f74d91856b6b87a29a7df11d8e2a30c3f5
AUNSORM_CLOCK_ATTESTATION={"authority_id":"Aunsorm Gul","authority_fingerprint_hex":"f4c9b1a27e38d34d9c0f4f8a96b3e2f74d91856b6b87a29a7df11d8e2a30c3f5","unix_time_ms":1761765689011,"stratum":2,"round_trip_ms":8,"dispersion_ms":12,"estimated_offset_ms":4,"signature_b64":"ZqV6X21vT2tfc5lnbmy0dXJl"}